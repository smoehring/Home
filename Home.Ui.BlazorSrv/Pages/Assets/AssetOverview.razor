@page "/Asset"

<MudStack>
    <MudPaper Outlined="false" Elevation="0" Class="pa-4 d-flex justify-end flex-grow-1 gap-4">
        <MudFab Icon="@Icons.Material.Filled.Add" Color="Color.Primary" @onclick="@(e => NavigationManager.NavigateTo("/Asset/New"))"/>
        <MudFab Icon="@Icons.Material.Filled.Print" Color="Color.Primary" @onclick="@(e => NavigationManager.NavigateTo("/Asset/Print"))"/>
    </MudPaper>
    <MudTable ServerData="@(new Func<TableState, Task<TableData<Asset>>>(ServerReload))" OnRowClick="Table_OnRowClick" T="Asset" @ref="_table">
        <ToolBarContent>
            <MudText Typo="Typo.h6">Assets</MudText>
            <MudSpacer/>
            <MudTextField T="string" ValueChanged="@(OnSearch)" Placeholder="Search" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"/>
        </ToolBarContent>
        <HeaderContent>
            <MudTh></MudTh>
            <MudTh>
                <MudTableSortLabel SortLabel="@nameof(Asset.Brand)" T="Asset">Brand</MudTableSortLabel>
            </MudTh>
            <MudTh>
                <MudTableSortLabel SortLabel="@nameof(Asset.Name)" T="Asset">Name</MudTableSortLabel>
            </MudTh>
            <MudTh>
                <MudTableSortLabel SortLabel="@nameof(Asset.AssetType)" T="Asset">Type</MudTableSortLabel>
            </MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd Class="cursor-pointer">
                @if (context.MediaId is not null)
                {<i class="bi bi-disc"></i>}
                @if (context.DeviceId is not null)
                {<i class="bi bi-projector"></i>}
                @if (context.PurchaseId is not null)
                {<i class="bi bi-currency-euro"></i>}
                @if (context.Artwork is not null)
                {<i class="bi bi-image"></i>}
                @if (context.Files is not null)
                {
                    <i class="bi bi-file-earmark"></i>
                }
            </MudTd>
            <MudTd Class="cursor-pointer">@context.Brand?.Name</MudTd>
            <MudTd Class="cursor-pointer">@context.Name</MudTd>
            <MudTd Class="cursor-pointer">@context.AssetType?.Name</MudTd>
        </RowTemplate>
        <NoRecordsContent>
            <MudText>Nothing to show.</MudText>
        </NoRecordsContent>
        <LoadingContent>
            <MudText>Loading...</MudText>
        </LoadingContent>
        <PagerContent>
            <MudTablePager ShowEntriesPerPage="true" ShowFirstLastButtons="true"/>
        </PagerContent>
    </MudTable>
</MudStack>